# Apache Spark + JDK: –ü–æ–ª–Ω—ã–π –≥–∞–π–¥ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ (Windows & macOS)

–≠—Ç–æ—Ç —Ç—É—Ç–æ—Ä–∏–∞–ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å –Ω—É–ª—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **Apache Spark** –∏ **JDK** —Ç–∞–∫, —á—Ç–æ–±—ã:

- Spark —Ä–∞–±–æ—Ç–∞–ª –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞/–∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏;
- –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤–µ—Ä—Å–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã;
- —Å—Ç—É–¥–µ–Ω—Ç—ã –º–æ–≥–ª–∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —à–∞–≥ –∑–∞ —à–∞–≥–æ–º.

## 0. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏

**–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–µ–∫ (–∏ –¥–ª—è Windows, –∏ –¥–ª—è macOS):**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç    | –í–µ—Ä—Å–∏—è                               |
|--------------|--------------------------------------|
| Java (JDK)   | **JDK 17 (LTS)**                     |
| Apache Spark | **Spark 3.5.7 (`spark-3.5.7-bin-hadoop3`)** |

Spark 3.5.x –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Java 8/11/17, –ø–æ—ç—Ç–æ–º—É JDK 17 ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–±–æ—Ä –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–µ—Ç –≤–ø–µ—Ä—ë–¥.

---

## –ß–∞—Å—Ç—å A. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Apache Spark 3.5.7 –Ω–∞ Windows 10/11

### A1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º JDK 17 (Windows)

1. –°–∫–∞—á–∞–π—Ç–µ JDK 17 (–ª—é–±—É—é OpenJDK-—Å–±–æ—Ä–∫—É), –Ω–∞–ø—Ä–∏–º–µ—Ä:
   - Adoptium Temurin 17 (MSI –¥–ª—è Windows x64)
   - –∏–ª–∏ Microsoft OpenJDK 17
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ JDK (Next‚ÄìNext‚ÄìFinish).
   –¢–∏–ø–æ–≤–æ–π –ø—É—Ç—å:
   - `C:\Program Files\Eclipse Adoptium\jdk-17.x.x.x-hotspot`
   - –∏–ª–∏ `C:\Program Files\Java\jdk-17.x.x`

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É –≤ **cmd**:

   ```cmd
   java -version

openjdk version "17.0.11" 2024-04-16
OpenJDK Runtime Environment ...
OpenJDK 64-Bit Server VM ...
–ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî –∑–Ω–∞—á–∏—Ç –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω PATH / JAVA_HOME.

A2. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –¥–ª—è Java (Windows)
–û—Ç–∫—Ä–æ–π—Ç–µ:

Win + X ‚Üí System (–∏–ª–∏ ¬´–ü–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Üí –°–∏—Å—Ç–µ–º–∞ ‚Üí –û —Å–∏—Å—Ç–µ–º–µ¬ª),

—Å–ø—Ä–∞–≤–∞/—Å–Ω–∏–∑—É ‚Äî –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º—ã,

–≤ –æ–∫–Ω–µ ¬´–°–≤–æ–π—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã¬ª –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã....

–í –±–ª–æ–∫–µ –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–∏–∂–Ω—è—è —á–∞—Å—Ç—å –æ–∫–Ω–∞) –Ω–∞–∂–º–∏—Ç–µ –°–æ–∑–¥–∞—Ç—å...:

–ò–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: JAVA_HOME

–ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: –ø—É—Ç—å –∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É JDK, –Ω–∞–ø—Ä–∏–º–µ—Ä:
C:\Program Files\Eclipse Adoptium\jdk-17.0.11.9-hotspot

–í —Å–ø–∏—Å–∫–µ –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞–π–¥–∏—Ç–µ Path ‚Üí –ò–∑–º–µ–Ω–∏—Ç—å... ‚Üí –°–æ–∑–¥–∞—Ç—å:

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:

text
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
%JAVA_HOME%\bin
–ù–∞–∂–º–∏—Ç–µ OK –≤–æ –≤—Å–µ—Ö –æ–∫–Ω–∞—Ö, –∑–∞–∫—Ä–æ–π—Ç–µ –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ cmd / PowerShell, –∑–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤–æ–µ –æ–∫–Ω–æ cmd.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

cmd
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
java -version
echo %JAVA_HOME%
A3. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ Apache Spark 3.5.7 (Windows)
–ó–∞–π–¥–∏—Ç–µ –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç Apache Spark –∏ —Å–∫–∞—á–∞–π—Ç–µ:

Release: 3.5.7

Package type: Pre-built for Apache Hadoop 3

–ê—Ä—Ö–∏–≤: spark-3.5.7-bin-hadoop3.tgz

–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ cmd:

cmd
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
C:
cd \
mkdir tools
cd tools
mkdir spark
–í –∏—Ç–æ–≥–µ –±—É–¥–µ—Ç –ø–∞–ø–∫–∞: C:\tools\spark.

–†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤ (spark-3.5.7-bin-hadoop3.tgz) –ø—Ä–∏ –ø–æ–º–æ—â–∏ 7-Zip:

–ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ ‚Üí 7-Zip ‚Üí Extract Here ‚Üí –ø–æ—è–≤–∏—Ç—Å—è spark-3.5.7-bin-hadoop3.tar

–ï—â—ë —Ä–∞–∑ –ø—Ä–∞–≤—ã–π –∫–ª–∏–∫ –Ω–∞ .tar ‚Üí **7-Zip ‚Üí Extract to "spark-3.5.7-bin-hadoop3"`

–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ –ø–∞–ø–∫—É spark-3.5.7-bin-hadoop3 –≤ C:\tools\spark.

–ò—Ç–æ–≥–æ–≤—ã–π –ø—É—Ç—å –∫ Spark:

text
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
C:\tools\spark\spark-3.5.7-bin-hadoop3
A4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ winutils.exe (Hadoop tools –¥–ª—è Windows)
–ù–∞ Windows Spark –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ Hadoop, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–µ–Ω winutils.exe.

–í cmd —Å–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫–∏:

```cmd
C:
cd \
mkdir hadoop
cd hadoop
mkdir bin
–¢–µ–ø–µ—Ä—å –µ—Å—Ç—å C:\hadoop\bin.

–°–∫–∞—á–∞–π—Ç–µ winutils.exe –¥–ª—è Hadoop 3.3.x (–ø—Ä–∏–º–µ—Ä —á–µ—Ä–µ–∑ curl):

```cmd
curl --ssl-no-revoke -L -o C:\hadoop\bin\winutils.exe ^
  https://github.com/cdarlint/winutils/raw/master/hadoop-3.3.5/bin/winutils.exe
‚ö†Ô∏è –≠—Ç–æ –Ω–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –±–∏–Ω–∞—Ä—å Apache, –∞ —É–¥–æ–±–Ω—ã–π –∫–æ—Å—Ç—ã–ª—å –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ Windows.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª —Å–∫–∞—á–∞–ª—Å—è:

```cmd
cd C:\hadoop\bin
dir
–í —Å–ø–∏—Å–∫–µ —Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å winutils.exe.

A5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SPARK_HOME –∏ HADOOP_HOME (Windows)
–°–Ω–æ–≤–∞ –æ—Ç–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ ¬´–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã¬ª (–∫–∞–∫ –≤ —à–∞–≥–µ A2).

–í –±–ª–æ–∫–µ –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞–∂–º–∏—Ç–µ –°–æ–∑–¥–∞—Ç—å... –∏ –¥–æ–±–∞–≤—å—Ç–µ:

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è 1:

–ò–º—è: SPARK_HOME

–ó–Ω–∞—á–µ–Ω–∏–µ: C:\tools\spark\spark-3.5.7-bin-hadoop3

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è 2:

–ò–º—è: HADOOP_HOME

–ó–Ω–∞—á–µ–Ω–∏–µ: C:\hadoop

–í —Å–ø–∏—Å–∫–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞–π–¥–∏—Ç–µ Path ‚Üí –ò–∑–º–µ–Ω–∏—Ç—å... ‚Üí –°–æ–∑–¥–∞—Ç—å –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫–∏:

```cmd
%SPARK_HOME%\bin
%HADOOP_HOME%\bin
–ù–∞–∂–º–∏—Ç–µ OK –≤–æ –≤—Å–µ—Ö –æ–∫–Ω–∞—Ö, –∑–∞–∫—Ä–æ–π—Ç–µ cmd, –æ—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤–æ–µ –æ–∫–Ω–æ cmd.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

```cmd
echo %SPARK_HOME%
echo %HADOOP_HOME%
spark-shell --version
–ü—Ä–∏ —É—Å–ø–µ—Ö–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤–µ—Ä—Å–∏—é Spark (3.5.7) –∏ –æ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç Scala shell.

A6. –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Spark –Ω–∞ Windows
Scala shell
```cmd
spark-shell
–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —É–≤–∏–¥–∏—Ç–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ:

```cmd
scala>
–ú–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç:

```cmd
scala> sc.parallelize(1 to 5).map(_ * 2).collect()
res0: Array[Int] = Array(2, 4, 6, 8, 10)
PySpark (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º)
```cmd
pyspark
–í –∫–æ–Ω—Ü–µ:

```text
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
Python 3.x.x (default, ...)
Type "help", "copyright", ...
>>>
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

```python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
>>> sc
>>> sc.version
–í–µ—Ä—Å–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 3.5.7.

A7. –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç PySpark (Windows)
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª C:\tools\spark\test_spark.py:

```python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
from pyspark.sql import SparkSession

spark = SparkSession.builder \
    .appName("TestSpark") \
    .getOrCreate()

print("Spark version:", spark.version)

df = spark.createDataFrame([(1, "Alice"), (2, "Bob")], ["id", "name"])
df.show()

spark.stop()
–ó–∞–ø—É—Å—Ç–∏—Ç–µ:

```cmd
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
cd C:\tools\spark
python test_spark.py
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è –≤–µ—Ä—Å–∏—è Spark –∏ —Ç–∞–±–ª–∏—á–∫–∞ —Å –¥–≤—É–º—è —Å—Ç—Ä–æ–∫–∞–º–∏ (Alice –∏ Bob).

–ß–∞—Å—Ç—å B. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Apache Spark 3.5.7 –Ω–∞ macOS (Intel / Apple Silicon)
B1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ JDK 17 —á–µ—Ä–µ–∑ Homebrew
–û—Ç–∫—Ä–æ–π—Ç–µ Terminal –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ Homebrew:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
brew --version
–ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Homebrew –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞.

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ JDK 17:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
brew install openjdk@17
–î–æ–±–∞–≤—å—Ç–µ JDK 17 –≤ PATH –∏ –∑–∞–¥–∞–π—Ç–µ JAVA_HOME (–¥–ª—è zsh):

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
echo 'export PATH="/opt/homebrew/opt/openjdk@17/bin:$PATH"' >> ~/.zshrc
echo 'export JAVA_HOME=$(/usr/libexec/java_home -v 17)' >> ~/.zshrc
source ~/.zshrc
–ù–∞ Intel Mac –ø—É—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å /usr/local/opt/openjdk@17/..., –Ω–æ –∫–æ–º–∞–Ω–¥–∞
/usr/libexec/java_home -v 17 —Å–∞–º–∞ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
java -version
echo $JAVA_HOME
B2. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ Spark 3.5.7 (macOS)
–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –ø–æ–¥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —Å–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ö–∏–≤:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
mkdir -p ~/tools
cd ~/tools
curl -L -O https://dlcdn.apache.org/spark/spark-3.5.7/spark-3.5.7-bin-hadoop3.tgz
–†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
tar -xvf spark-3.5.7-bin-hadoop3.tgz
–ü–∞–ø–∫–∞ —Å Spark:

```text
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
~/tools/spark-3.5.7-bin-hadoop3
B3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SPARK_HOME –∏ PATH –Ω–∞ macOS
–û—Ç–∫—Ä–æ–π—Ç–µ / —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª ~/.zshrc –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫–∏:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
export SPARK_HOME="$HOME/tools/spark-3.5.7-bin-hadoop3"
export PATH="$SPARK_HOME/bin:$PATH"
–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
source ~/.zshrc
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
echo $SPARK_HOME
spark-shell --version
–î–æ–ª–∂–Ω–∞ –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –≤–µ—Ä—Å–∏—è Spark 3.5.7.

üí° –ù–∞ macOS –ù–ï –Ω—É–∂–µ–Ω winutils.exe ‚Äî —ç—Ç–æ –∫–æ—Å—Ç—ã–ª—å –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è Windows.

B4. –ü—Ä–æ–≤–µ—Ä–∫–∞ Spark –Ω–∞ macOS
Scala shell
```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
spark-shell
–í –∫–æ–Ω—Å–æ–ª–∏:

```scala
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
scala> sc.parallelize(1 to 5).sum()
res0: Double = 15.0
PySpark
```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
pyspark
–í–Ω—É—Ç—Ä–∏ REPL:

```python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
>>> sc
>>> sc.version
B5. –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç PySpark (macOS)
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª ~/tools/test_spark.py:

```python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
from pyspark.sql import SparkSession

spark = SparkSession.builder \
    .appName("TestSparkMac") \
    .getOrCreate()

print("Spark version:", spark.version)

df = spark.range(5)
df.show()

spark.stop()
–ó–∞–ø—É—Å–∫:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
cd ~/tools
python3 test_spark.py
–ü—Ä–∏ —É—Å–ø–µ—Ö–µ –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–∞ –≤–µ—Ä—Å–∏—è Spark –∏ —Ç–∞–±–ª–∏—Ü–∞ —Å —á–∏—Å–ª–∞–º–∏ 0‚Äì4.

–ß–∞—Å—Ç—å C. PySpark –≤ Jupyter Notebook
–í–∞—Ä–∏–∞–Ω—Ç 1. PySpark —á–µ—Ä–µ–∑ pip (–º–∏–Ω–∏–º—É–º –±–æ–ª–∏ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤)
–í —Ç–æ–π –∂–µ —Å—Ä–µ–¥–µ (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ / Conda), –≥–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Jupyter, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
pip install pyspark
–ó–∞–ø—É—Å—Ç–∏—Ç–µ Jupyter (Notebook / Lab) –∏ –≤ –Ω–æ–≤–æ–π —è—á–µ–π–∫–µ:

```python
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
from pyspark.sql import SparkSession

spark = SparkSession.builder \
    .appName("JupyterTest") \
    .getOrCreate()

print("Spark:", spark.version)
spark.range(10).show()
PySpark –ø–æ–¥—Ç—è–Ω–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π Spark (–µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω SPARK_HOME) –∏–ª–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Spark.

–í–∞—Ä–∏–∞–Ω—Ç 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Spark (—á–µ—Ä–µ–∑ SPARK_HOME)
–î–ª—è –æ–±–æ–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (Windows –∏ macOS) –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –±—ã–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:

JAVA_HOME ‚Üí –ø—É—Ç—å –∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É JDK 17;

SPARK_HOME ‚Üí –ø—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ Spark spark-3.5.7-bin-hadoop3;

PATH —Å–æ–¥–µ—Ä–∂–∏—Ç $SPARK_HOME/bin (–∏–ª–∏ %SPARK_HOME%\bin –Ω–∞ Windows).

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ –≤—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PySpark (pip install pyspark) –∏ –≤—ã–∑–æ–≤–µ—Ç–µ –µ–≥–æ –≤ –Ω–æ—É—Ç–±—É–∫–µ, –æ–Ω —Å–º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Spark.

–ß–∞—Å—Ç—å D. –ú–∏–Ω–∏-—á–µ–∫–ª–∏—Å—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (Windows & macOS)
–ï—Å–ª–∏ Spark –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–ª–∏ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è SparkContext:

```java -version
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Java 17, –∞ –Ω–µ 1.8 / 11 / 21.

JAVA_HOME

Windows: echo %JAVA_HOME%

macOS: echo $JAVA_HOME
–ü—É—Ç—å –¥–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é JDK 17.

SPARK_HOME

Windows: echo %SPARK_HOME%

macOS: echo $SPARK_HOME
–î–æ–ª–∂–µ–Ω —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é spark-3.5.7-bin-hadoop3.

PATH
–í PATH –¥–æ–ª–∂–Ω—ã —Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å:

Windows: %JAVA_HOME%\bin, %SPARK_HOME%\bin, %HADOOP_HOME%\bin (–µ—Å–ª–∏ –Ω–∞ Windows).

macOS: $JAVA_HOME/bin, $SPARK_HOME/bin.

–ü—Ä–æ–≤–µ—Ä–∫–∞ spark-shell --version
–ï—Å–ª–∏ shell –≤–æ–æ–±—â–µ –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç ‚Äî –æ—à–∏–±–∫–∞ –≤ JAVA_HOME –∏–ª–∏ SPARK_HOME.

–î–ª—è Windows:

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ C:\hadoop\bin\winutils.exe.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é HADOOP_HOME –∏ –Ω–∞–ª–∏—á–∏–µ %HADOOP_HOME%\bin –≤ Path.

–î–ª—è Jupyter:

–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ –ø–∞–∫–µ—Ç pyspark –≤ —Ç–æ–π –∂–µ —Å—Ä–µ–¥–µ, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω Jupyter (pip show pyspark)?

–ù–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç –ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–π Python / —Ä–∞–∑–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è?

–≠—Ç–æ—Ç README –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

–∫–∞–∫ —É—á–µ–±–Ω—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (—à–∞–≥–∏ 0 ‚Üí A ‚Üí B ‚Üí C ‚Üí D),

–∫–∞–∫ —á–µ–∫–ª–∏—Å—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∫—É—Ä—Å–æ–º –ø–æ Spark / Data Engineering / Big Data,

–∫–∞–∫ –æ—Å–Ω–æ–≤—É –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π (Docker, Kubernetes, Spark-–∫–ª–∞—Å—Ç–µ—Ä –∏ —Ç.–¥.).
